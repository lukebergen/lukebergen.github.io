<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">pGHRhcGCglMxMono:JkjY98yFSQF2ON5U29D2jw==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
