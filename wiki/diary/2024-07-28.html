<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">j9WOH7NJtyASflJf:qSiYHV++idUoCg9CZsa2kQ==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
