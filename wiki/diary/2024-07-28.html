<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">hAn+fw/g0cnN8XjY:1rcZUY+bLsHEFR+bU/zIVw==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
