<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">dXfaaEvweq+60udG:K0O8IWZqNSerPNOF9U2OVg==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
