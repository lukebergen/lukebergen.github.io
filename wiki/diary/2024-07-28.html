<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">N/BtkAaY2oQ8Bnln:TO83q5C0wNhB7ronoXHtWg==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
