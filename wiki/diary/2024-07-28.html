<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">1lY6hBqISA+E6vJA:DT2bCpmpBeggI7iJfzOnTw==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
