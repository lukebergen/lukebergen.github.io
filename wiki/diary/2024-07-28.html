<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">gundbP/QjFZw/olu:dpdvYp1CpCXks9UqNC+TrA==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
          passwordsStr = window.localStorage.getItem("passwords") || "{}";
          passwords = JSON.parse(passwordsStr);
          passwords["1"] = password;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
