<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">G9BWkOx9bjXSKDx3:V9BWbcgnyXTxH3P96JPugg==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
