<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">0Sh3TM3BItt72Qt5:DPoF5ZMrd/UFpZWnyIl6zw==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
