<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">vhNHq4ChZu8RmVMy:rbpAYB3v2af9jv2dG9D2wA==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
