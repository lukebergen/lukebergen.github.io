<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">YcYlgnpuNWe8P4an:rA9Vh0W9V8cVHrmBxM64ww==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
