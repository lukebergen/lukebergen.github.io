<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">y97XU+VmPZCKv07q:Y00zDf/2LrTOERvEw8KblA==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
