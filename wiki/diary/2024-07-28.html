<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">Lsg7BByho++fYwmD:ovXckM5ELjNx/pzjTFhzZw==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
