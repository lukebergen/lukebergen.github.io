<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">8/qnKtOmr9NNTtEw:6Drt8HE+bDI1YzyNZfIKcA==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
