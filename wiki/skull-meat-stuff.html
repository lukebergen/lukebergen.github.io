<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(0). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">jb91Ft+Ig8ow36ss:4wqHMwpRuAAOxAvvPp1N9Q==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["0"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["0"]) {
        document.getElementById("password").value = passwords["0"];
      }
    </script>
  </body>
</html>
