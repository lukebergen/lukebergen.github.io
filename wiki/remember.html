<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(2). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">XSyLa5XEgk4HzABM:1aJxOsqf2Zz9Y+vM+DJMTw==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["2"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["2"]) {
        document.getElementById("password").value = passwords["2"];
      }
    </script>
  </body>
</html>
