<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(2). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">wGyokxFLqmcuxBRs:II8Ujar/c2KThmovC60W8Q==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["2"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["2"]) {
        document.getElementById("password").value = passwords["2"];
      }
    </script>
  </body>
</html>
