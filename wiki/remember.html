<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(2). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">17eTwb1yPAbGkg8B:13B1NhTLS/7LC5bd3xsLgQ==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["2"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["2"]) {
        document.getElementById("password").value = passwords["2"];
      }
    </script>
  </body>
</html>
