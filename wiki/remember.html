<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(2). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">F/yE7X9aNHZlBntR:sqwqL3bthG0X/T4hjX1Sag==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
