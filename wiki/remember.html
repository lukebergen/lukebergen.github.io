<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(2). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">74dpe3qvGiSaDQY7:AiquojxQN39LpsdQZDwFUw==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["2"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["2"]) {
        document.getElementById("password").value = passwords["2"];
      }
    </script>
  </body>
</html>
