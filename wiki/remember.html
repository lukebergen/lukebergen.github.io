<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(2). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">+5qdO3p34VKwgGpU:epPWAGxXEP86brjpaGLRpg==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
