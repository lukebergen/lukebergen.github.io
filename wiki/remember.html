<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(2). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">vP2AXO+qzsMwP72S:/YIA4YDgqtVK5n6az4nRrg==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["2"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["2"]) {
        document.getElementById("password").value = passwords["2"];
      }
    </script>
  </body>
</html>
