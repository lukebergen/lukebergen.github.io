<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(2). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">k1ClO75Qr1oI92Er:Q8W5aR0ef81DvGaM0WEAIg==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
