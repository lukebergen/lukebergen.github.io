<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">RLQ+yaut2s2SQIY3:8JRqgtaxecAR+fOFdfArFQ==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
