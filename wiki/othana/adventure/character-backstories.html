<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">6sd38CtCsPTU3ynC:p2DZU2DUGXLkJjk2ek7aew==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
