<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">KvU9FYoV1kUHlw51:aHUCdc4gkbFSHE6QlOn7HA==:m/JL2FSObFwqE/WRDKrX+WINHD+ZF8oBDC9SBZRU8AhAbUDh/SSa9Fd/BKuS5MXRF+H7Aqze05hgq6HozlipAI1japU243waYDVvF7k8YKPJ/XUIrE4jRv1ptU3SE0BW3AYKhfrd0FAY5gNlenXr9cWJnBoixJ84vyEOoMCbDpy3fyhNBdQkufoPTRVxAYSkMuJNQA+9/3Ey9hhrcjM/C53kK/l2a5Y+6gFt4FaDSRUXlDsREo8Mktm24wo+4B8t9G8bUtQSUeB0geSiPOhzwik4U2xr0NQ/+BW5GLHpH+raDW+LMwkWKy+3aW+RHgppm/qbJETlv0ER5ClvHH+MpQRwZ3cjIVpCix6E4lUK4xPqQXZSe8WHI7A2C5u6I3KTCdu1pzDEtgxDnR03TFH0hakZp3vNUOTjMEaPKeKF/oYJbYh6sd+ZG2l85f+yr6d8/oGEHOwIfw2M7szj1LTOlaAIRozLHfor6VKEU4UvS+DvpSwlY+0uATxdWDggLrWgnmXhOhja5XY7ggjn4OfmLB633MJf+EyaVdN+GdaCaDphilcilgMqtY9jw30CODGQfagpZUf61d8rNkVHJVFfQ74r8bs+bM44Y9BZD4asM5gBAeodLx0SUqCW1UwoAKInsLodhDxE9dFGhqBxTDYFBq7sq6+gZqZoLINeWX7GUUvtBEWkf0VttlTx6TVyKxYUFKScoVGtir6VnOUTMrpVwUubu9kAxyFQ/fXdaPL3OHlFGJF6Mrm6aiYnDyLCbYa1rQW0dkj/yXDpOSx4ZmgAAiU7tD+OEQ998OkyCZT5fixqjwRrGBpGs08/qbUudIf0on7tFYvTi+1J9xpiZAlGA+ZH+YTYqSt5nl9lue2K/I96EX05ImD1QYHjc01YUsxmhtIgToB+pLPI8yG3cCn+AqxrNjCp2y/pFjkxYXkoq1usDcRGN16RNXLvqdQ921/BskXpZriF9J5XJ4C9yt99GpcoYMz80uJ3vPk+10Us1oC9dLmKmIw9zVrBHF8FV4I7yIcoMbOfpDoeVKdEu9Ffv6M07Dd6l3NiqH140tFYuwYizC1aEkwyz0TUx6iCJjBTDJarSBN+meJn8OPEFIqhBJLq5ZN37RxILafk3HruAXDdIi0fzzdxwSKGDybZmwieTv+Cmy5t1nEhzd2UZkUhzGjbCFWMTIZcezGTJopo3r1pAXU5lT39a2JCPIQ3jJZ9U17nYpXJutN5h2lEt12UvM7G42WFKeGRjlUh/anpCXC9woOkUG5UtQ+9rHxrvqkxKJbDIMnxpM2QaIextH59K2UIfB/DeDCdSyEaTp20oilHemLMpldSN9h4Lq0PHWevlWEQAHDNn3BBCbxaxZK4jS73zSwa7J5QaKUj1tExbK7CZq8HO7f0/m894mY5A1v/xc9YKQ6JhYlZ0/AZFnYSmC3muoZzqPZVAeJXAqklC3WBPAuMpzzG+vwk1MxxWS11fgRkS3rQOulh97b0Def4maLbOC7A9tZupjXuir1GFSUscs8ljY1PPcj5e05rFOevgHcImXejXKByoIXXspibO5ESESYttFQ5OI/O3/noD+/tcn73DRzISBuw1zgmyryIsrqkyVGGvJXfwPRMTDydVFs2+/OQsK7fd55ksU+WfoiC/y0boWgyKy/Gfc8JCMdI97DAgBImmfqQTpraxa6ZABzXeCGQVhLUCX4J21pxqgCHLLx/qYtpLeZF3ELtjeillce9iUNCZZqruPXyttXbTikKWULseUEHweTcOA9zD6sXUeKA5Jz7tXlfS/ddsKVJMgE2zAZdmXopRKkiEZaWkHslMgbXmsC9bxxv/tXtoi8+2Gc+suP1DuAWT8rK9wDQaRDkEl3N60/BQzod5K9vXdzIj8UEx7pB7qfCf2v1M6p6o98z66eyIB+vNAlLN8t7PJkjCnt8U39LwKd0vejKhmRAyWlsebcqSdkKakLz4kEsSsYbokb3jYjzWMmXoOGDyW8HnsQ+xdUMkWsvNWKwwzBzWu9a/cJkwQmJnRXIRT06gdi7J6V2kBoT7E5Kv+VleOx6MmrJMMkv47ImdLf+OWFO6in3w+DaGvHzPGlcrUgKJ2hah3a8p5DWJ6LZcGZ13VvmB00d+tXNE/fadqCW0+HhXsmp9b4YaUthDbj3dODKo8dweEglbTeg9P5c1+5X5QJ/RrscnXnodapDHBbivFLYUhFF0BgaO2C0Hp6cO5hbR2kYUZbw+UJDH2v4UPkcq9wYKhbYRp3TdgrVFRTalr755ibhw2EnY1EetGGSoYe7gWT49S6ltRWjUD6MZfUsZUGPff1J3neKdOlOv5q3BWEHLspcUejb9ye+LfBgqpvzodhBWKPJflnQnk5hpLCeVqJGlbs2op2PP2R82Jgxe2Sh2tzuWgL2P2mbKU56z09QCaElmGGa6egCW6e/aiRYG2qwB5T3YzFN557FAXjm/pZMMiOEtt7OBeIjRZZ7KPzP/ro1TYpszOTpuHPW5WUDgx1doC3wFH1E9oZPKJbYuV3VYDAOrZNmhFg6o73hoT0L5vj7dFnWePDlCObPOeiuwG0uWqDcX6Q95x/kPNGFtpXSU8QsFvmNG8lQepqDbKY32nIvkTikuVxo2LNUItexmnSdSktRHzOOOUC9RnDrwDmXVQpmB8HxRnP3yKTo13814Alkdmgy0hUu7hCqGq8Ydu2QXJWVt0KzLx3BfELhve1iXTXWqMDku2dqYfvj+RYSxYMHdTrFn+QCZJ1I3SPI6faZvvqJhlI7miW8WauSjcexF4zRP0KXEEtE/lDzk3KPgldVCn0dOx9YF1YyEnPL6Uef1829K7shDrPZoZNlo+EwTL9/n4TQaAhkYzMKR5zr9uLoqPbUF1WPd7MbHjYpIt1v6d0e3Q4tekvnsEy9RwrtaFqUnlyc8JpI4+AmabVXcI4TO3f82BmcnMEs5Xr9eGXsPPpRww2fiYwWk0P0xgMqp/K64Ypy76AvU2wbGqLHO8wJn6EoLQyPYDv0JeuuQwBh8dLe/xv2K3s33Ja6vIuZOrJqfzmx4NGPP+adH5oopsCjXQNTpb8OWDNdgkhjAEkv3MOKhgQHXSLwFSnjtl5vxZ/fg6zq4Tj0FnvMe/YfY2OaHxRG2N0ncisFxx14w56Y7/blXVPfxz+ImLILLSRbtTGmiSVTy4/efGIp78YkYGEQJMBSW6VtoiDFSh1f7whKSaMJLmNKu9K8LRq8JTXom4EwqvrTlex8I6MZLgwreM261DutGJEirChIhUrOOZXg482x0cObanN0kRNgzEDDecV4XVrqJ8SA2VPIWgH5CDaVrdJrbMjfWBHIj4OUdFNeoXIxcKkTx8KKVm56PTdITGUi9Nbq3/FkjmkCcfdGbtESsqA4TiMBActLtsnswvrjhCMuCgv4YWTyRTogmkzqxUgSD1WyoFzaeN7VXW4c3uzxt9gPxBVJ2TrjzODnk3Gh6G83rvMltcmrZrHHlzpZZAJhnFoPMOor0uiwrVYW64EcC+rVfQdwGf50xvz5BCerPYCNIz/9pCL2uGwU1Q9OFHGRHiHVHwsaMZ0hsmOLD7YWjj4Mqkovs2GzC9e8pxBmywao+jvEAxAv/s/biaXE8HGHIT4Vaul9i2tFxARWP9RPbWaBAqlUAgYS7RG7r6cjTt65n7E0Dz+0j5vUb6W4AsS0Y1Gy1xJjmDTCfv5FVgG7Lw8AB6d3kXO2WnAlkyd7ApLRur7xwILVt1NBbz8sXDLicGogJM+ST8q04snKY4j+eotq7E/V4fNYTDHroEAT9dJchy3c35bXXsSDedSilBo6lhkZQZCe5cVvJrjphbVSaQzniOA4mUy81WUcecpiEZtwqglMN2Q8NjVMLTY5GAYW62VTOcYZNi6/svCbFgSkOjIHJICl7CKG9pyi5aYnkCAFrncMnUs4NLIMDXEXjF9152AW/lqeXn1aFMkJZ7Fb8/N4M71ULGdKrISNJwfurRFWBp+eb5hdH8jYV/sXDsRREJaqIS8LzjpTXgio6JVB7NnDMEFE3v6LhOOlhWJuql9cKoJyivWGfLirfV5k9DKbrT80ybLS76V5RlHnR8MYf7RJ2FtXj9+xRwQ0JD+njZWXdnF++NqmnRdCDOpTr0PaorGKwN4y5ZetWH8=</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
