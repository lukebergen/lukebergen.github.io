<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">9/eewjxFePnSYs7n:NpJCN04L36j6Fcm1wpAWjg==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
