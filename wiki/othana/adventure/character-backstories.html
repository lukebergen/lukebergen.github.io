<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">OFN00/MXPcb3IVS7:+7iTRi4V/QqpQ6fiLhDc0g==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
