<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">j0d3o66MFK/+SCl/:XyZ8/q2QXrAGx73frV8w9g==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
