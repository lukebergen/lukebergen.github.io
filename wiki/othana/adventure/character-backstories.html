<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">dGMwzgvVTS7OZ+rU:VvtLu0bhIJKBat52z6sEgg==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
