<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">i59os0Yu9PXfKDM0:O9sCxMrMgWKbe8J2C3vTzg==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
