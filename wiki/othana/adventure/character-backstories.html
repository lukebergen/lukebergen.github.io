<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">UgaihhMstECoO1is:CufUxegDRzNgRygXPLaUCQ==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          window.pw = password;
          window.cipherx = cipher;
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
        } catch(err) {
          console.log(err);
          alert("nope");
        }
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });
    </script>
  </body>
</html>
