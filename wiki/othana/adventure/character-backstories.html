<!DOCTYPE html>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="https://www.lukebergen.com/wiki/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
    <title>psych</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>(() => {
  global = (typeof global === 'undefined') ? window : global;
  const base64 = (buffer) => {
    let binaryString = '';
    for (let i = 0; i < buffer.length; i++) {
      binaryString += String.fromCharCode(buffer[i]);
    }
    return global.btoa(binaryString);
  };

  const debase64 = (base64Str) => {
    const binaryString = atob(base64Str);
    
    // Create a Uint8Array from the binary string
    const uint8Array = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      uint8Array[i] = binaryString.charCodeAt(i);
    }

    // Create an ArrayBuffer from the Uint8Array
    return uint8Array;
  }

  const getKey = async (keyMaterial, salt) => {
    return global.crypto.subtle.deriveKey(
      {
        name: "PBKDF2",
        salt: salt, 
        iterations: 100000,
        hash: "SHA-256"
      },
      keyMaterial,
      { "name": "AES-GCM", "length": 256},
      true,
      [ "encrypt", "decrypt" ]
    );
  }

  const encrypt = async (plain, password) => {
    const enc = new TextEncoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    salt = global.crypto.getRandomValues(new Uint8Array(16));

    const key = await getKey(keyMaterial, salt);

    iv = global.crypto.getRandomValues(new Uint8Array(12));

    cipher = await global.crypto.subtle.encrypt(
      { name: "AES-GCM", iv },
      key,
      enc.encode(plain)
    );
    cipher = new Uint8Array(cipher);

    return `${base64(iv)}:${base64(salt)}:${base64(cipher)}`;
  }

  const decrypt = async (str, password) => {
    const [iv, salt, cipher] = str.split(":").map(debase64);

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const keyMaterial = await global.crypto.subtle.importKey(
      "raw", 
      enc.encode(password), 
      {name: "PBKDF2"}, 
      false, 
      ["deriveBits", "deriveKey"]
    );

    const key = await getKey(keyMaterial, salt);
    const r = await global.crypto.subtle.decrypt({name: "AES-GCM", iv}, key, cipher)

    return dec.decode(r);
  };

  if (typeof window !== 'undefined') {
    window.encrypt = encrypt;
    window.decrypt = decrypt;
  } else if (typeof module !== 'undefined') {
    module.exports = {encrypt, decrypt};
  } else {
    console.log("no window and no module... where are you running me?");
  }
})()
</script>
  </head>
  <body>
    <p>Private(1). This page contains private stuff. Feel free to hit me up for the password unless you're a bot.</p>
    <input id="password" type="password" />
    <button id="decrypt">Decrypt</button>

    <div id="encryptedContent" style="margin-top: 20px;">od8ziY/2U3Ha2mc5:sS3gGywsh2pBn4O4EbjRVA==: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</div>
    <script>
      const doDecrypt = async () => {
        const password = document.getElementById("password").value;
        const cipher = document.getElementById("encryptedContent").innerHTML;
        try {
          const plain = await decrypt(cipher, password);
          document.body.innerHTML = plain;
          // it was legit, so save it
        } catch(err) {
          console.log(err);
          alert("nope");
          return;
        }

        const passwordsStr = window.localStorage.getItem("passwords") || "{}";
        let passwords = JSON.parse(passwordsStr);
        passwords["1"] = password;
        window.localStorage.setItem("passwords", JSON.stringify(passwords));
      };
      document.getElementById("decrypt").addEventListener("click", doDecrypt);
      document.getElementById("password").addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          doDecrypt();
        }
      });

      // initial page load
      const passwordsStr = window.localStorage.getItem("passwords") || '{}';
      const passwords = JSON.parse(passwordsStr);
      if (passwords["1"]) {
        document.getElementById("password").value = passwords["1"];
      }
    </script>
  </body>
</html>
